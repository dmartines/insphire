{"version":3,"sources":["meteor://ðŸ’»app/packages/manuelschoebel_ms-seo/packages/manuelschoebel_ms-seo.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wH","file":"/packages/manuelschoebel_ms-seo.js","sourcesContent":["(function () {\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                             //\n// packages/manuelschoebel:ms-seo/seo_collection.coffee.js                                                     //\n//                                                                                                             //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                               //\n__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;\nthis.SeoCollection = new Mongo.Collection('seo');\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n\n\n\n\n(function () {\n\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                                             //\n// packages/manuelschoebel:ms-seo/seo.coffee.js                                                                //\n//                                                                                                             //\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                                               //\n__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;\nvar SEO, escapeHtmlAttribute, getCurrentRouteName;\n\nSEO = {\n  settings: {\n    title: '',\n    rel_author: '',\n    meta: [],\n    og: [],\n    twitter: [],\n    ignore: {\n      meta: ['fragment'],\n      link: ['stylesheet', 'icon', 'apple-touch-icon']\n    },\n    auto: {\n      twitter: true,\n      og: true,\n      set: ['description', 'url', 'title']\n    }\n  },\n  ignore: function(type, value) {\n    if (this.settings.ignore[type] && _.indexOf(this.settings.ignore[type], value) === -1) {\n      return this.settings.ignore[type].push(value);\n    }\n  },\n  config: function(settings) {\n    return _.extend(this.settings, settings);\n  },\n  set: function(options, clearBefore) {\n    var currentRouter, k, l, link, m, meta, o, og, twitter, url, v, _i, _j, _k, _l, _len, _len1, _len2, _len3;\n    if (clearBefore == null) {\n      clearBefore = true;\n    }\n    if (clearBefore) {\n      this.clearAll();\n    }\n    currentRouter = Router.current();\n    if (currentRouter) {\n      url = Router.url(currentRouter.route.getName(), currentRouter.params);\n    }\n    meta = options.meta;\n    og = options.og;\n    link = options.link;\n    twitter = options.twitter;\n    if (options.title) {\n      this.setTitle(options.title);\n    }\n    if (options.url) {\n      this.setUrl(options.url);\n    } else if (url) {\n      this.setUrl(url);\n    }\n    if (meta && _.isArray(meta)) {\n      for (_i = 0, _len = meta.length; _i < _len; _i++) {\n        m = meta[_i];\n        this.setMeta(\"name='\" + m.key + \"'\", m.value);\n      }\n    } else if (meta && _.isObject(meta)) {\n      for (k in meta) {\n        v = meta[k];\n        this.setMeta(\"name='\" + k + \"'\", v);\n      }\n    }\n    if (og && _.isArray(og)) {\n      for (_j = 0, _len1 = og.length; _j < _len1; _j++) {\n        o = og[_j];\n        this.setMeta(\"property='og:\" + o.key + \"'\", o.value);\n      }\n    } else if (og && _.isObject(og)) {\n      for (k in og) {\n        v = og[k];\n        this.setMeta(\"property='og:\" + k + \"'\", v);\n      }\n    }\n    if (link && _.isArray(link)) {\n      for (_k = 0, _len2 = link.length; _k < _len2; _k++) {\n        l = link[_k];\n        this.setLink(l.rel, l.href);\n      }\n    } else if (link && _.isObject(link)) {\n      for (k in link) {\n        v = link[k];\n        this.setLink(k, v);\n      }\n    }\n    if (twitter && _.isArray(twitter)) {\n      for (_l = 0, _len3 = twitter.length; _l < _len3; _l++) {\n        o = twitter[_l];\n        this.setMeta(\"property='twitter:\" + o.key + \"'\", o.value);\n      }\n    } else if (twitter && _.isObject(twitter)) {\n      for (k in twitter) {\n        v = twitter[k];\n        this.setMeta(\"property='twitter:\" + k + \"'\", v);\n      }\n    }\n    if (options.rel_author) {\n      return this.setLink('author', options.rel_author);\n    }\n  },\n  clearAll: function() {\n    var $l, $m, controlled, ignored, l, m, _i, _j, _len, _len1, _ref, _ref1;\n    _ref = $(\"meta\");\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      m = _ref[_i];\n      $m = $(m);\n      controlled = $m.attr('name') || $m.attr('property');\n      ignored = false;\n      if ($m.attr('name') && _.indexOf(SEO.settings.ignore.meta, $m.attr('name')) > -1) {\n        ignored = true;\n      } else if ($m.attr('property') && _.indexOf(SEO.settings.ignore.meta, $m.attr('property')) > -1) {\n        ignored = true;\n      }\n      if (!ignored && controlled) {\n        $m.remove();\n      }\n    }\n    _ref1 = $(\"link\");\n    for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n      l = _ref1[_j];\n      $l = $(l);\n      controlled = $l.attr('rel');\n      if (_.indexOf(SEO.settings.ignore.link, $l.attr('rel')) === -1 && controlled) {\n        $l.remove();\n      }\n    }\n    this.set(this.settings, false);\n    return this.setTitle(this.settings.title);\n  },\n  setTitle: function(title) {\n    document.title = title;\n    if (_.indexOf(this.settings.auto.set, 'title') !== -1) {\n      if (this.settings.auto.twitter) {\n        this.setMeta('property=\"twitter:title\"', title);\n      }\n      if (this.settings.auto.og) {\n        return this.setMeta('property=\"og:title\"', title);\n      }\n    }\n  },\n  setUrl: function(url) {\n    if (_.indexOf(this.settings.auto.set, 'url') !== -1) {\n      if (this.settings.auto.twitter) {\n        this.setMeta('property=\"twitter:url\"', url);\n      }\n      if (this.settings.auto.og) {\n        return this.setMeta('property=\"og:url\"', url);\n      }\n    }\n  },\n  setLink: function(rel, href, unique) {\n    var h, _i, _len;\n    if (unique == null) {\n      unique = true;\n    }\n    if (unique) {\n      this.removeLink(rel);\n    }\n    if (_.isArray(href)) {\n      for (_i = 0, _len = href.length; _i < _len; _i++) {\n        h = href[_i];\n        this.setLink(rel, h, false);\n      }\n      return;\n    }\n    if (href) {\n      return $('head').append(\"<link rel='\" + rel + \"' href='\" + href + \"'>\");\n    }\n  },\n  removeLink: function(rel) {\n    return $(\"link[rel='\" + rel + \"']\").remove();\n  },\n  setMeta: function(attr, content, unique) {\n    var name, v, _i, _len;\n    if (unique == null) {\n      unique = true;\n    }\n    if (unique) {\n      this.removeMeta(attr);\n    }\n    if (_.isArray(content)) {\n      for (_i = 0, _len = content.length; _i < _len; _i++) {\n        v = content[_i];\n        this.setMeta(attr, v, false);\n      }\n      return;\n    }\n    if (!content) {\n      return;\n    }\n    content = escapeHtmlAttribute(content);\n    $('head').append(\"<meta \" + attr + \" content='\" + content + \"'>\");\n    name = attr.replace(/\"|'/g, '').split('=')[1];\n    if (_.indexOf(this.settings.auto.set, name) !== -1) {\n      if (this.settings.auto.twitter) {\n        this.setMeta(\"property='twitter:\" + name + \"'\", content);\n      }\n      if (this.settings.auto.og) {\n        return this.setMeta(\"property='og:\" + name + \"'\", content);\n      }\n    }\n  },\n  removeMeta: function(attr) {\n    return $(\"meta[\" + attr + \"]\").remove();\n  }\n};\n\nthis.SEO = SEO;\n\nescapeHtmlAttribute = function(string) {\n  return (\"\" + string).replace(/'/g, \"&apos;\").replace(/\"/g, \"&quot;\");\n};\n\ngetCurrentRouteName = function() {\n  var routeName, router;\n  router = Router.current();\n  if (!router) {\n    return;\n  }\n  routeName = router.route.getName();\n  return routeName;\n};\n\nDeps.autorun(function() {\n  var currentRouteName;\n  currentRouteName = getCurrentRouteName();\n  if (!currentRouteName) {\n    return;\n  }\n  return Meteor.subscribe('seoByRouteName', currentRouteName);\n});\n\nDeps.autorun(function() {\n  var currentRouteName, settings;\n  if (!SEO) {\n    return;\n  }\n  currentRouteName = getCurrentRouteName();\n  settings = SeoCollection.findOne({\n    route_name: currentRouteName\n  }) || {};\n  return SEO.set(settings);\n});\n/////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n"]}